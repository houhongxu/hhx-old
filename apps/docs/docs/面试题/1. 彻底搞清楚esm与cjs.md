# 彻底搞清楚 esm 与 cjs

## chalk5 只支持 esm

chalk5 不支持 cjs
[见文档](https://github.com/chalk/chalk)

> IMPORTANT: Chalk 5 is ESM. If you want to use Chalk with TypeScript or a build tool, you will probably want to use Chalk 4 for now. Read more.

## 浏览器等不支持 导入 mjs 文件

mdx 也不支持导入 使用 mjs 文件 的库
但是支持 antd 源码使用的的 导入方式，
因为里面 esm 导入方式的文件也是 js 文件
所以研究了一下， tsup 可以 打包为支持 esm 的库，但是不使用 mjs
[见文档](https://tsup.egoist.dev/#output-extension)

## esm 与 cjs 互相引入

esm 是异步
cjs 是同步

esm 可以直接引入 cjs
cjs 引入 esm 需要处理，require 改成 await import ，且需要异步环境

> tsc 会处理 await import 为 require，则需要封装函数 c`onst dynamicImport = new Function('m', 'return import(m)');` 包装一下 await import

## ts

ts 配置 "esModuleInterop": true // 在 ESM 语法中导入 CJS 模块时通常需要加上这个配置
可以 ESM 语法中直接导入 CJS 模块
